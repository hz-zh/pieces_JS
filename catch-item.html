<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body {
      margin: 0;
      overflow: hidden;
      height: 100vh;
      width: 100%;
    }

      nav {
         position: fixed;
         top: 50%;
         left: 50%;
         width: 50%;
         height: 7%;
         margin-left: -25%;
         margin-top: -3.5%;
         display: flex;
         justify-content: center;
         align-items: center;
         gap: 2%;
         flex-wrap: wrap;
         background-color: transparent;
      }

      nav button {
         margin: 0;
         padding: 10px 20px;
         width:31%;
         height: 100%;
         border: solid 2px #ffffff;
         border-radius: 5px;
         background-color: transparent;
         background-image: linear-gradient(to bottom, #4b3c5c37, 35%, rgba(200, 200, 200, 0.673) 50%, #524e3c79 65%);
         color: #fff;
         font-size: 18px;
         cursor: pointer;
         min-width: 120px;
         /* get wallpoet font from Wallpoet-Regular.tff*/
         font-family: "wallpoet";
         font-weight: bold;
      }

      #game-display {
         position: absolute;
         top: 30%;
         left: 50%;
         width: 45%;
         height: 7%;
         margin-left: -22.5%;
         margin-top: -3.5%;
         display: flex;
         justify-content: center;
         align-items: center;
         background-color: black;
         color: white;
         font-size: 18px;
         font-family: "wallpoet";
         font-weight: bold;
         border-radius: 14px;
   
      }

    #game-container {
      position: relative;
      width: 100vw;
      height: 100vh;
      background-color: black;
      background-position: center;
      background-size: cover;
    }

    #game-container div {
      background-size: cover;
      background-position: center;
    }

    #ball1 {
      position: absolute;
      width: 50px;
      height: 50px;
      background-color: #ffffff;
      border-radius: 50%;
      cursor: pointer;
      display: none;
    }

      #ball2 {
         position: absolute;
         width: 50px;
         height: 50px;
         background-color: #ffffff;
         border-radius: 50%;
         cursor: pointer;
         display: none;
      }

      #ball3 {
         position: absolute;
         width: 50px;
         height: 50px;
         background-color: #ffffff;
         border-radius: 50%;
         cursor: pointer;
         display: none;
      }

      #ball4 {
         position: absolute;
         width: 50px;
         height: 50px;
         background-color: #ffffff;
         border-radius: 50%;
         cursor: pointer;
         display: none;
      }

      #ball5 {
         position: absolute;
         width: 50px;
         height: 50px;
         background-color: #ffffff;
         border-radius: 50%;
         cursor: pointer;
         display: none;
      }

      #prev {
         position: absolute;
         top: 0%;
         left: 0%;
         z-index: 5;
         margin: 2%;
         margin-top: 1%;
         transform: rotate(180deg);
      }

     #next-img {
         width: 50px;
         height: 50px;
         margin: 0;
         padding: 0;
      }

      #next {
         position: absolute;
         top: 0%;
         right: 0%;
         z-index: 5;
         margin: 2%;
         margin-top: 1%;
      }

      #attribute_1 {
         position: absolute;
         bottom: 0%;
         left: 0%;
         margin: 0;
         padding: 14px;
         font-size: 14px;
         color: white;
         display: none;
         background-color: #5b90b4aa;
         border-radius: 10px;
      }

      #attribute_2 {
         position: absolute;
         bottom: 0%;
         left: 0%;
         margin: 0;
         padding: 14px;
         font-size: 14px;
         color: white;
         display: none;
      }

      #attribute_3 {
         position: absolute;
         bottom: 0%;
         left: 0%;
         margin: 0;
         padding: 14px;
         font-size: 14px;
         color: white;
         display: none;
      }



  </style>
</head>
<body>
   <a id="next" href="index.html"><img id="next-img" src="./images/next.png"></a>
   <a id="prev" href="index.html"><img id="next-img" src="./images/next.png"></a>
   <div id="game-container">
      <div id="ball1"></div>
      <div id="ball2"></div>
      <div id="ball3"></div>
      <div id="ball4"></div>
      <div id="ball5"></div>
  </div>
<nav id="controls">
   <button id="mode1">click ball</button>
   <button id="mode2">avoid</button>
   <button id="mode3">avoid-and-click</button>
</nav>
<p id="game-display">Complete three games to continue.</p>
<p id="attribute_1">FreeFunArt via Pixabay</p>
<p id="attribute_2">DavidRockDesign via Pixabay</p>
<p id="attribute_3">Stefan Schweihofer via Pixabay</p>
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.3/gsap.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/2.0.1/TweenMax.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/2.0.1/TimelineMax.min.js"></script>

<script>
class Ball {
  constructor(gameContainer, ballElement, ballSpeedX, ballSpeedY, size, background="null") {
    this.gameContainer = gameContainer;
    this.ballElement = ballElement;
    this.ballSpeedX = ballSpeedX;
    this.ballSpeedY = ballSpeedY;
    this.size = size; // px
    this.background = background;
    this.interval = null;
    this.gameActive = false;
    this.resetGame();
    this.navButtons = document.querySelectorAll("nav button");
  }
   setSize() {
      this.ballElement.style.height = this.size + "px";
      this.ballElement.style.width = this.size + "px";
   }

   setBackground() {
      if (this.background == "click1") {
         this.ballElement.style.backgroundImage = "url('./images/click-ball.png')";
      }
      else if (this.background == "click2") {
         this.ballElement.style.backgroundImage = "url('./images/avoid-click-ball.png')";
      }
      else {
         this.ballElement.style.backgroundImage = "url('./images/avoid-ball.png')";
      }
   }

  resetGame() {
    this.ballX = Math.random() * (this.gameContainer.offsetWidth - this.ballElement.offsetWidth);
    this.ballY = Math.random() * (this.gameContainer.offsetHeight - this.ballElement.offsetHeight);
    this.updateBallPosition();
    this.ballElement.style.display = "none";
    this.ballElement.style.backgroundImage = "none";
    clearInterval(this.interval);
    this.gameActive = false;
  }

  updateBallPosition() {
    this.ballElement.style.left = this.ballX + "px";
    this.ballElement.style.top = this.ballY + "px";
  }

  updateBall() {
    this.ballX += this.ballSpeedX;
    this.ballY += this.ballSpeedY;

    // Check for collisions with walls
    if (this.ballX <= 0 || this.ballX >= this.gameContainer.offsetWidth - this.ballElement.offsetWidth) {
      this.ballSpeedX = -this.ballSpeedX;
    }

    if (this.ballY <= 0 || this.ballY >= this.gameContainer.offsetHeight - this.ballElement.offsetHeight) {
      this.ballSpeedY = -this.ballSpeedY;
    }

    // Update ball position
    this.updateBallPosition();
  }


  start() {
   
   // if any of the nav buttons are red, set them back to blue and reset the game
   for (var i = 0; i < this.navButtons.length; i++) {
      if (this.navButtons[i].style.backgroundColor == "red") {
         this.navButtons[i].style.backgroundColor = "#3498db";
         this.resetGame();
      }
   }
   this.setSize();
   this.setBackground();
   this.ballElement.style.display = "block";
   this.gameActive = true;
   this.interval = setInterval(this.updateBall.bind(this), 16); // 60 frames per second
  
  }
}

// end of Ball class //

var gameContainer = document.getElementById("game-container");
var ball1 = document.getElementById("ball1");
var ball2 = document.getElementById("ball2");
var ball3 = document.getElementById("ball3");
var ball4 = document.getElementById("ball4");
var ball5 = document.getElementById("ball5");
var controls = document.getElementById("controls");
var attribute_click = document.getElementById("attribute_1");
var attribute_avoid = document.getElementById("attribute_2");
var attribute_avoid_click = document.getElementById("attribute_3");
var next = document.getElementById("next");
var prev = document.getElementById("prev");
var gameDisplay = document.getElementById("game-display");

function gameMode(mode) {
   if (mode == "normal") {

      ball_normal = new Ball(gameContainer, ball1, 5, 5, 70, "click1");
      ball_normal.start();

      // watch for click events on the ball
      ball1.addEventListener("click", function ball1Click() {
         setTimeout(function() {
            alert("Congratulations! You've won!");
            ball_normal.resetGame();
            mode1.style.color = "white";
            controls.style.display = "flex";
            next.style.display = "block";
            prev.style.display = "block";
            attribute_click.style.display = "none";
            gsap.to("#game-container", {duration: 1, opacity: 0, onComplete: function() {
               gsap.to("#game-container", {duration: 1, backgroundImage: "none"});
               gsap.to("#game-container", {duration: 1, opacity: 1});
            }});
         }, 500);
         this.removeEventListener("click", ball1Click);
      });
   }
   else if (mode == "avoid") {
      ball1_avoid = new Ball(gameContainer, ball1, 3, 3, 90, false, true);
      ball2_avoid = new Ball(gameContainer, ball2, 5, 5, 75, false, true);
      ball3_avoid = new Ball(gameContainer, ball3, 7, 7, 60, false, true);
      ball4_avoid = new Ball(gameContainer, ball4, 9, 9, 45, false, true);
      ball5_avoid = new Ball(gameContainer, ball5, 11, 11, 30, false, true);

      ball1_avoid.start();
      ball2_avoid.start();
      ball3_avoid.start();
      ball4_avoid.start();
      ball5_avoid.start();


      function removeEventListeners() {
         ball1.removeEventListener("mouseover", ball1Mouse);
         ball2.removeEventListener("mouseover", ball2Mouse);
         ball3.removeEventListener("mouseover", ball3Mouse);
         ball4.removeEventListener("mouseover", ball4Mouse);
         ball5.removeEventListener("mouseover", ball5Mouse);
      }

      function ball1Mouse() {
         removeEventListeners();
         endGame();
      }

      function ball2Mouse() {
         removeEventListeners();
         endGame();
      }

      function ball3Mouse() {
         removeEventListeners();
         endGame();
      }

      function ball4Mouse() {
         removeEventListeners();
         endGame();
      }

      function ball5Mouse() {
         removeEventListeners();
         endGame();
      }

      ball1.addEventListener("mouseover", ball1Mouse);
      ball2.addEventListener("mouseover", ball2Mouse);
      ball3.addEventListener("mouseover", ball3Mouse);
      ball4.addEventListener("mouseover", ball4Mouse);
      ball5.addEventListener("mouseover", ball5Mouse);

      endGame = function(win = false) {
         ball1_avoid.resetGame();
         ball2_avoid.resetGame();
         ball3_avoid.resetGame();
         ball4_avoid.resetGame();
         ball5_avoid.resetGame();

        if (win) {
            mode2.innerText = "complete";
            mode2.style.fontStyle = "italic";  
            gameDisplay.innerText = "Game 2 complete";
            gameDisplay.style.display = "flex";
         }
         else {
            mode2.innerText = "avoid";
            gameDisplay.innerText = "Game 2 failed";
            gameDisplay.style.display = "flex";
         }

         setTimeout( function() {
            gameDisplay.innerText = "complete three games to continue";
            gsap.to("#game-container", {duration: 1, opacity: 0, onComplete: function() {
               gsap.to("#game-container", {duration: 1, backgroundImage: "none"});
               gsap.to("#game-container", {duration: 1, opacity: 1});
               mode2.style.color = "white";
               controls.style.display = "flex";
               next.style.display = "block";
               prev.style.display = "block";
               attribute_avoid.style.display = "none";
            }});
         }, 5000
         );
      }
   }
   else if (mode == "avoid-and-click") {
      ball1.style.backgroundColor = "transparent";

      ball1_avoidClick = new Ball(gameContainer, ball1, 3, 3, 120, "click2");
      ball2_avoidClick = new Ball(gameContainer, ball2, 5, 5, 100);
      ball3_avoidClick = new Ball(gameContainer, ball3, 7, 7, 85);
      ball4_avoidClick = new Ball(gameContainer, ball4, 9, 9, 70);
      ball5_avoidClick = new Ball(gameContainer, ball5, 11, 11, 55);

      ball1_avoidClick.start();
      ball2_avoidClick.start();
      ball3_avoidClick.start();
      ball4_avoidClick.start();
      ball5_avoidClick.start();

      function removeEventListeners() {
         ball1.removeEventListener("mouseover", ball1Mouse);
         ball2.removeEventListener("mouseover", ball2Mouse);
         ball3.removeEventListener("mouseover", ball3Mouse);
         ball4.removeEventListener("mouseover", ball4Mouse);
         ball5.removeEventListener("mouseover", ball5Mouse);
      }

      function ball1Click() {
         removeEventListeners();
         endGame(true);
      }

      function ball2Mouse() {
         removeEventListeners();
         endGame();
      }

      function ball3Mouse() {
         removeEventListeners();
         endGame();
      }

      function ball4Mouse() {
         removeEventListeners();
         endGame();
      }

      function ball5Mouse() {
         removeEventListeners();
         endGame();
      }
      // watch for click events on ball1 and mouseover events on the other balls
      ball1.addEventListener("click", ball1Click);
      ball2.addEventListener("mouseover", ball2Mouse);
      ball3.addEventListener("mouseover", ball3Mouse);
      ball4.addEventListener("mouseover", ball4Mouse);
      ball5.addEventListener("mouseover", ball5Mouse);

      endGame = function(win = false) {
         ball1_avoidClick.resetGame();
         ball2_avoidClick.resetGame();
         ball3_avoidClick.resetGame();
         ball4_avoidClick.resetGame();
         ball5_avoidClick.resetGame();

         if (win) {
            mode3.innerText = "complete";
            mode3.style.fontStyle = "italic";  
            gameDisplay.innerText = "Game 3 complete";
            gameDisplay.style.display = "flex";
         }
         else {
            mode3.innerText = "avoid-and-click";
            gameDisplay.innerText = "Game 3 failed";
            gameDisplay.style.display = "flex";
         }
         setTimeout( function() {
            gameDisplay.innerText = "complete three games to continue";
            
            gsap.to("#game-container", {duration: 1, opacity: 0, onComplete: function() {
               gsap.to("#game-container", {duration: 1, backgroundImage: "none"});
               gsap.to("#game-container", {duration: 1, opacity: 1});
               mode3.style.color = "white";
               controls.style.display = "flex";
               next.style.display = "block";
               prev.style.display = "block";
               attribute_avoid_click.style.display = "none";
            }});
         }, 5000
         );
      }
   }
}

const mode1 = document.getElementById("mode1");
mode1.addEventListener("click", function() {
if (this.style.color == "black") {
   this.style.color = "white";
   // reset the Ball class  //
   ball_normal.resetGame();
   ball1.style.display = "none";
   gsap.to("#game-container", {duration: 1, opacity: 0, onComplete: function() {
      gsap.to("#game-container", {duration: 1, backgroundImage: "none"});
      gsap.to("#game-container", {duration: 1, opacity: 1});
      attribute_click.style.display = "none";
      next.style.display = "block";
      prev.style.display = "block";
   }});
   return;
} else {
   this.style.color = "black";
   controls.style.display = "none";
   gsap.to("#game-container", {duration: 1, opacity: 0, onComplete: function() {
      gsap.to("#game-container", {duration: 1, backgroundImage: "url('./images/normal-background.png')"});
      gsap.to("#game-container", {duration: 1, opacity: 1});
      attribute_click.style.display = "block";
      next.style.display = "none";
      prev.style.display = "none";
      gameDisplay.style.display = "none";
      setTimeout(function() {
         gameMode("normal");
      }, 2000);
   }});
   
}
});

const mode2 = document.getElementById("mode2")
mode2.addEventListener("click", function() {
   if (this.style.color == "black") {
      this.style.color = "white";
      // reset the Ball class  //
      ball1_avoid.resetGame();
      ball2_avoid.resetGame();
      ball3_avoid.resetGame();
      ball4_avoid.resetGame();
      ball5_avoid.resetGame();

      gsap.to("#game-container", {duration: 1, opacity: 0, onComplete: function() {
         gsap.to("#game-container", {duration: 1, backgroundImage: "none"});
         gsap.to("#game-container", {duration: 1, opacity: 1});
         attribute_avoid.style.display = "none";
         next.style.display = "block"; 
         prev.style.display = "block";
      }});
      return;
   } else {
      this.style.color = "black";
      controls.style.display = "none";
      gsap.to("#game-container", {duration: 1, opacity: 0, onComplete: function() {
         gsap.to("#game-container", {duration: 1, backgroundImage: "url('./images/avoid.png')"});
         gsap.to("#game-container", {duration: 1, opacity: 1});
         attribute_avoid.style.display = "block";
         next.style.display = "none";
         prev.style.display = "none";
         gameDisplay.style.display = "none";
         setTimeout(function() {
            gameMode("avoid");
         }, 2000);
      }});
   }
});

const mode3 = document.getElementById("mode3")
mode3.addEventListener("click", function() {
   if (this.style.color == "black") {
      this.style.color = "white";
      // reset the Ball class  //
      ball1_avoidClick.resetGame();
      ball2_avoidClick.resetGame();
      ball3_avoidClick.resetGame();
      ball4_avoidClick.resetGame();
      ball5_avoidClick.resetGame();
  
      gsap.to("#game-container", {duration: 1, opacity: 0, onComplete: function() {
         gsap.to("#game-container", {duration: 1, backgroundImage: "none"});
         gsap.to("#game-container", {duration: 1, opacity: 1});
         attribute_avoid_click.style.display = "none";
         next.style.display = "block";
         prev.style.display = "block";
      }});
      return;
   } else {
      this.style.color = "black";
      controls.style.display = "none";
      gsap.to("#game-container", {duration: 1, opacity: 0, onComplete: function() {
         gsap.to("#game-container", {duration: 1, backgroundImage: "url('./images/avoid-and-click.png')"});
         gsap.to("#game-container", {duration: 1, opacity: 1});
         attribute_avoid_click.style.display = "block";
         next.style.display = "none";
         prev.style.display = "none";
         gameDisplay.style.display = "none";
         setTimeout(function() {
            gameMode("avoid-and-click");
         }, 2000);
      }});
     
   }
});

/*
ball2.style.display = "block";
ball3.style.display = "block";
ball4.style.display = "block";
ball5.style.display = "block";
var ball1 = new Ball(gameContainer, ball1, 3, 3, 400, true);   
var ball2 = new Ball(gameContainer, ball2, 3, 3, 80);
var ball3 = new Ball(gameContainer, ball3, 3, 3, 90);
var ball4 = new Ball(gameContainer, ball4, 3, 3, 100);
var ball5 = new Ball(gameContainer, ball5 , 3, 3, 60);


ball1.start();
ball2.start();
ball3.start();
ball4.start();
ball5.start();

*/
/*
      // Make this into a class to make it easier to create multiple balls //
      var ballSpeedX1 = 5; // Horizontal speed
      var ballSpeedY1 = 5; // Vertical speed
      // Initialize ball position
      var ballX1 = Math.random() * (gameContainer.offsetWidth - ball1.offsetWidth);
      var ballY1 = Math.random() * (gameContainer.offsetHeight - ball1.offsetHeight);

      ball.style.left = ballX1 + "px";
      ball.style.top = ballY1 + "px";

      function updateBall() {
        ballX += ballSpeedX;
        ballY += ballSpeedY;

        // Check for collisions with walls
        if (ballX <= 0 || ballX >= gameContainer.offsetWidth - ball.offsetWidth) {
          ballSpeedX = -ballSpeedX;
        }

        if (ballY <= 0 || ballY >= gameContainer.offsetHeight - ball.offsetHeight) {
          ballSpeedY = -ballSpeedY;
        }

        // Update ball position
        ball.style.left = ballX + "px";
        ball.style.top = ballY + "px";
      }

      // Function to handle click events on the ball
      function handleBallClick() {
        alert("Congratulations! You've won!");

        resetGame();
      }

      function resetGame() {
        ballX = Math.random() * (gameContainer.offsetWidth - ball.offsetWidth);
        ballY = Math.random() * (gameContainer.offsetHeight - ball.offsetHeight);

        ball.style.left = ballX + "px";
        ball.style.top = ballY + "px";
      }

      setInterval(updateBall, 16); // 60 frames per second
      ball1.addEventListener("click", handleBallClick);
    }); */
  </script>
</body>
</html>
